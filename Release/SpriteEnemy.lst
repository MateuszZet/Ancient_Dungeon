                              1 ;--------------------------------------------------------
                              2 ; File Created by SDCC : free open source ANSI-C Compiler
                              3 ; Version 3.6.0 #9615 (MINGW64)
                              4 ;--------------------------------------------------------
                              5 	.module SpriteEnemy
                              6 	.optsdcc -mgbz80
                              7 	
                              8 ;--------------------------------------------------------
                              9 ; Public variables in this module
                             10 ;--------------------------------------------------------
                             11 	.globl _SpriteManagerRemoveSprite
                             12 	.globl _PlayFx
                             13 	.globl _CheckCollision
                             14 	.globl _TranslateSprite
                             15 	.globl _SetSpriteAnim
                             16 	.globl _dir_pointer
                             17 	.globl _dir
                             18 	.globl _bank_SPRITE_ENEMY
                             19 	.globl _anim_walk
                             20 	.globl _anim_walk2
                             21 	.globl _Start_SPRITE_ENEMY
                             22 	.globl _Update_SPRITE_ENEMY
                             23 	.globl _Destroy_SPRITE_ENEMY
                             24 ;--------------------------------------------------------
                             25 ; ram data
                             26 ;--------------------------------------------------------
                             27 	.area _DATA
   0000                      28 _bank_SPRITE_ENEMY::
   0000                      29 	.ds 1
   0001                      30 _dir::
   0001                      31 	.ds 2
   0003                      32 _dir_pointer::
   0003                      33 	.ds 2
                             34 ;--------------------------------------------------------
                             35 ; absolute external ram data
                             36 ;--------------------------------------------------------
                             37 	.area _DABS (ABS)
                             38 ;--------------------------------------------------------
                             39 ; global & static initialisations
                             40 ;--------------------------------------------------------
                             41 	.area _HOME
                             42 	.area _GSINIT
                             43 	.area _GSFINAL
                             44 	.area _GSINIT
                             45 ;SpriteEnemy.c:3: UINT8 bank_SPRITE_ENEMY = 2;
   0000 21r00r00             46 	ld	hl,#_bank_SPRITE_ENEMY
   0003 36 02                47 	ld	(hl),#0x02
                             48 ;SpriteEnemy.c:12: int dir=0;
   0005 21r01r00             49 	ld	hl,#_dir
   0008 36 00                50 	ld	(hl),#0x00
   000A 23                   51 	inc	hl
   000B 36 00                52 	ld	(hl),#0x00
                             53 ;SpriteEnemy.c:13: int *dir_pointer = NULL;
   000D 21r03r00             54 	ld	hl,#_dir_pointer
   0010 36 00                55 	ld	(hl),#0x00
   0012 23                   56 	inc	hl
   0013 36 00                57 	ld	(hl),#0x00
                             58 ;--------------------------------------------------------
                             59 ; Home
                             60 ;--------------------------------------------------------
                             61 	.area _HOME
                             62 	.area _HOME
                             63 ;--------------------------------------------------------
                             64 ; code
                             65 ;--------------------------------------------------------
                             66 	.area _CODE_2
                             67 ;SpriteEnemy.c:19: void Start_SPRITE_ENEMY() {
                             68 ;	---------------------------------
                             69 ; Function Start_SPRITE_ENEMY
                             70 ; ---------------------------------
   0000                      71 _Start_SPRITE_ENEMY::
   0000 E8 FC                72 	add	sp, #-4
                             73 ;SpriteEnemy.c:20: struct EnemyInfo* data = (struct EnemyInfo*)THIS->custom_data;
   0002 21r01r00             74 	ld	hl,#_THIS + 1
   0005 2B                   75 	dec	hl
   0006 4E                   76 	ld	c,(hl)
   0007 23                   77 	inc	hl
   0008 46                   78 	ld	b,(hl)
   0009 21 18 00             79 	ld	hl,#0x0018
   000C 09                   80 	add	hl,bc
   000D 7D                   81 	ld	a,l
   000E 54                   82 	ld	d,h
   000F F8 02                83 	ldhl	sp,#2
   0011 22                   84 	ld	(hl+),a
   0012 72                   85 	ld	(hl),d
   0013 2B                   86 	dec	hl
   0014 2A                   87 	ld	a,(hl+)
   0015 5E                   88 	ld	e, (hl)
   0016 F8 00                89 	ldhl	sp,#0
   0018 22                   90 	ld	(hl+),a
   0019 73                   91 	ld	(hl),e
                             92 ;SpriteEnemy.c:21: THIS->lim_x=9999;
   001A 21 12 00             93 	ld	hl,#0x0012
   001D 09                   94 	add	hl,bc
   001E 4D                   95 	ld	c,l
   001F 44                   96 	ld	b,h
   0020 3E 0F                97 	ld	a,#0x0f
   0022 02                   98 	ld	(bc),a
   0023 03                   99 	inc	bc
   0024 3E 27               100 	ld	a,#0x27
   0026 02                  101 	ld	(bc),a
                            102 ;SpriteEnemy.c:22: THIS->lim_y=9999;
   0027 21r01r00            103 	ld	hl,#_THIS + 1
   002A 2B                  104 	dec	hl
   002B 4E                  105 	ld	c,(hl)
   002C 23                  106 	inc	hl
   002D 46                  107 	ld	b,(hl)
   002E 21 14 00            108 	ld	hl,#0x0014
   0031 09                  109 	add	hl,bc
   0032 4D                  110 	ld	c,l
   0033 44                  111 	ld	b,h
   0034 3E 0F               112 	ld	a,#0x0f
   0036 02                  113 	ld	(bc),a
   0037 03                  114 	inc	bc
   0038 3E 27               115 	ld	a,#0x27
   003A 02                  116 	ld	(bc),a
                            117 ;SpriteEnemy.c:23: data->vy = 1;
   003B E1                  118 	pop	hl
   003C E5                  119 	push	hl
   003D 36 01               120 	ld	(hl),#0x01
                            121 ;SpriteEnemy.c:25: SetSpriteAnim(THIS, anim_walk2, 15);
   003F 3E 0F               122 	ld	a,#0x0f
   0041 F5                  123 	push	af
   0042 33                  124 	inc	sp
   0043 21r56r00            125 	ld	hl,#_anim_walk2
   0046 E5                  126 	push	hl
   0047 21r00r00            127 	ld	hl,#_THIS
   004A 2A                  128 	ld	a,(hl+)
   004B 66                  129 	ld	h,(hl)
   004C 6F                  130 	ld	l,a
   004D E5                  131 	push	hl
   004E CDr00r00            132 	call	_SetSpriteAnim
   0051 E8 05               133 	add	sp, #5
   0053 E8 04               134 	add	sp, #4
   0055 C9                  135 	ret
   0056                     136 _anim_walk2:
   0056 02                  137 	.db #0x02	; 2
   0057 01                  138 	.db #0x01	; 1
   0058 02                  139 	.db #0x02	; 2
   0059                     140 _anim_walk:
   0059 02                  141 	.db #0x02	; 2
   005A 03                  142 	.db #0x03	; 3
   005B 04                  143 	.db #0x04	; 4
                            144 ;SpriteEnemy.c:29: void Update_SPRITE_ENEMY() {
                            145 ;	---------------------------------
                            146 ; Function Update_SPRITE_ENEMY
                            147 ; ---------------------------------
   005C                     148 _Update_SPRITE_ENEMY::
   005C E8 FC               149 	add	sp, #-4
                            150 ;SpriteEnemy.c:34: struct EnemyInfo* data = (struct EnemyInfo*)THIS->custom_data;
   005E 21r01r00            151 	ld	hl,#_THIS + 1
   0061 2B                  152 	dec	hl
   0062 4E                  153 	ld	c,(hl)
   0063 23                  154 	inc	hl
   0064 46                  155 	ld	b,(hl)
   0065 21 18 00            156 	ld	hl,#0x0018
   0068 09                  157 	add	hl,bc
   0069 4D                  158 	ld	c,l
   006A 44                  159 	ld	b,h
                            160 ;SpriteEnemy.c:35: dir_pointer = &dir;
   006B 21r03r00            161 	ld	hl,#_dir_pointer
   006E 36r01               162 	ld	(hl),#<(_dir)
   0070 23                  163 	inc	hl
   0071 36s00               164 	ld	(hl),#>(_dir)
                            165 ;SpriteEnemy.c:39: if (TranslateSprite(THIS, 0, data->vy)) {
   0073 0A                  166 	ld	a,(bc)
   0074 57                  167 	ld	d,a
   0075 C5                  168 	push	bc
   0076 D5                  169 	push	de
   0077 33                  170 	inc	sp
   0078 AF                  171 	xor	a, a
   0079 F5                  172 	push	af
   007A 33                  173 	inc	sp
   007B 21r00r00            174 	ld	hl,#_THIS
   007E 2A                  175 	ld	a,(hl+)
   007F 66                  176 	ld	h,(hl)
   0080 6F                  177 	ld	l,a
   0081 E5                  178 	push	hl
   0082 CDr00r00            179 	call	_TranslateSprite
   0085 E8 04               180 	add	sp, #4
   0087 C1                  181 	pop	bc
   0088 7B                  182 	ld	a,e
   0089 B7                  183 	or	a, a
   008A CArF9r00            184 	jp	Z,00105$
                            185 ;SpriteEnemy.c:41: data->vy = -data->vy;
   008D 0A                  186 	ld	a,(bc)
   008E F8 03               187 	ldhl	sp,#3
   0090 77                  188 	ld	(hl),a
   0091 AF                  189 	xor	a, a
   0092 96                  190 	sub	a, (hl)
   0093 77                  191 	ld	(hl),a
   0094 7E                  192 	ld	a,(hl)
   0095 02                  193 	ld	(bc),a
                            194 ;SpriteEnemy.c:43: PlayFx(CHANNEL_4, 4, 0x0c, 0x41, 0x30, 0xc0);
   0096 21 C0 00            195 	ld	hl,#0x00c0
   0099 E5                  196 	push	hl
   009A 2E 30               197 	ld	l, #0x30
   009C E5                  198 	push	hl
   009D 2E 41               199 	ld	l, #0x41
   009F E5                  200 	push	hl
   00A0 2E 0C               201 	ld	l, #0x0c
   00A2 E5                  202 	push	hl
   00A3 21 03 04            203 	ld	hl,#0x0403
   00A6 E5                  204 	push	hl
   00A7 CDr00r00            205 	call	_PlayFx
   00AA E8 0A               206 	add	sp, #10
                            207 ;SpriteEnemy.c:44: if (dir == 0) {
   00AC 21r02r00            208 	ld	hl,#_dir + 1
   00AF 3A                  209 	ld	a,(hl-)
   00B0 B6                  210 	or	a,(hl)
   00B1 20 24               211 	jr	NZ,00102$
                            212 ;SpriteEnemy.c:45: SetSpriteAnim(THIS, anim_walk, 15);
   00B3 3E 0F               213 	ld	a,#0x0f
   00B5 F5                  214 	push	af
   00B6 33                  215 	inc	sp
   00B7 21r59r00            216 	ld	hl,#_anim_walk
   00BA E5                  217 	push	hl
   00BB 21r00r00            218 	ld	hl,#_THIS
   00BE 2A                  219 	ld	a,(hl+)
   00BF 66                  220 	ld	h,(hl)
   00C0 6F                  221 	ld	l,a
   00C1 E5                  222 	push	hl
   00C2 CDr00r00            223 	call	_SetSpriteAnim
   00C5 E8 05               224 	add	sp, #5
                            225 ;SpriteEnemy.c:46: *dir_pointer = 1;
   00C7 21r04r00            226 	ld	hl,#_dir_pointer + 1
   00CA 2B                  227 	dec	hl
   00CB 4E                  228 	ld	c,(hl)
   00CC 23                  229 	inc	hl
   00CD 46                  230 	ld	b,(hl)
   00CE 3E 01               231 	ld	a,#0x01
   00D0 02                  232 	ld	(bc),a
   00D1 03                  233 	inc	bc
   00D2 3E 00               234 	ld	a,#0x00
   00D4 02                  235 	ld	(bc),a
   00D5 18 22               236 	jr	00105$
   00D7                     237 00102$:
                            238 ;SpriteEnemy.c:49: SetSpriteAnim(THIS, anim_walk2, 15);
   00D7 3E 0F               239 	ld	a,#0x0f
   00D9 F5                  240 	push	af
   00DA 33                  241 	inc	sp
   00DB 21r56r00            242 	ld	hl,#_anim_walk2
   00DE E5                  243 	push	hl
   00DF 21r00r00            244 	ld	hl,#_THIS
   00E2 2A                  245 	ld	a,(hl+)
   00E3 66                  246 	ld	h,(hl)
   00E4 6F                  247 	ld	l,a
   00E5 E5                  248 	push	hl
   00E6 CDr00r00            249 	call	_SetSpriteAnim
   00E9 E8 05               250 	add	sp, #5
                            251 ;SpriteEnemy.c:50: *dir_pointer = 0;
   00EB 21r04r00            252 	ld	hl,#_dir_pointer + 1
   00EE 2B                  253 	dec	hl
   00EF 4E                  254 	ld	c,(hl)
   00F0 23                  255 	inc	hl
   00F1 46                  256 	ld	b,(hl)
   00F2 3E 00               257 	ld	a,#0x00
   00F4 02                  258 	ld	(bc),a
   00F5 03                  259 	inc	bc
   00F6 3E 00               260 	ld	a,#0x00
   00F8 02                  261 	ld	(bc),a
   00F9                     262 00105$:
                            263 ;SpriteEnemy.c:56: SPRITEMANAGER_ITERATE(i, spr) {
   00F9 FAr01r00            264 	ld	a, (#(_sprite_manager_updatables + 0x0001) + 0)
   00FC 4F                  265 	ld	c,a
   00FD 06 00               266 	ld	b,#0x00
   00FF CB 21               267 	sla	c
   0101 CB 10               268 	rl	b
   0103 21r00r00            269 	ld	hl,#_sprite_manager_sprites
   0106 09                  270 	add	hl,bc
   0107 4D                  271 	ld	c,l
   0108 44                  272 	ld	b,h
   0109 59                  273 	ld	e, c
   010A 50                  274 	ld	d, b
   010B 1A                  275 	ld	a,(de)
   010C 4F                  276 	ld	c,a
   010D 13                  277 	inc	de
   010E 1A                  278 	ld	a,(de)
   010F 47                  279 	ld	b,a
   0110 F8 00               280 	ldhl	sp,#0
   0112 36 00               281 	ld	(hl),#0x00
   0114                     282 00112$:
   0114 11r00r00            283 	ld	de, #_sprite_manager_updatables + 0
   0117 1A                  284 	ld	a,(de)
   0118 F8 03               285 	ldhl	sp,#3
   011A 77                  286 	ld	(hl),a
   011B F8 00               287 	ldhl	sp,#0
   011D 7E                  288 	ld	a,(hl)
   011E F8 03               289 	ldhl	sp,#3
   0120 96                  290 	sub	a, (hl)
   0121 CAr9Fr01            291 	jp	Z,00114$
                            292 ;SpriteEnemy.c:57: if (spr->type == SPRITE_BOMB) {
   0124 21 10 00            293 	ld	hl,#0x0010
   0127 09                  294 	add	hl,bc
   0128 7D                  295 	ld	a,l
   0129 54                  296 	ld	d,h
   012A F8 01               297 	ldhl	sp,#1
   012C 22                  298 	ld	(hl+),a
   012D 72                  299 	ld	(hl),d
   012E 2B                  300 	dec	hl
   012F 5E                  301 	ld	e,(hl)
   0130 23                  302 	inc	hl
   0131 56                  303 	ld	d,(hl)
   0132 1A                  304 	ld	a,(de)
   0133 D6 06               305 	sub	a, #0x06
   0135 C2r7Ar01            306 	jp	NZ,00113$
                            307 ;SpriteEnemy.c:58: if (CheckCollision(THIS, spr)) {
   0138 C5                  308 	push	bc
   0139 C5                  309 	push	bc
   013A 21r00r00            310 	ld	hl,#_THIS
   013D 2A                  311 	ld	a,(hl+)
   013E 66                  312 	ld	h,(hl)
   013F 6F                  313 	ld	l,a
   0140 E5                  314 	push	hl
   0141 CDr00r00            315 	call	_CheckCollision
   0144 E8 04               316 	add	sp, #4
   0146 C1                  317 	pop	bc
   0147 7B                  318 	ld	a,e
   0148 B7                  319 	or	a, a
   0149 28 2F               320 	jr	Z,00113$
                            321 ;SpriteEnemy.c:59: SpriteManagerRemoveSprite(THIS);
   014B C5                  322 	push	bc
   014C 21r00r00            323 	ld	hl,#_THIS
   014F 2A                  324 	ld	a,(hl+)
   0150 66                  325 	ld	h,(hl)
   0151 6F                  326 	ld	l,a
   0152 E5                  327 	push	hl
   0153 CDr00r00            328 	call	_SpriteManagerRemoveSprite
   0156 E8 02               329 	add	sp, #2
   0158 C1                  330 	pop	bc
                            331 ;SpriteEnemy.c:60: PlayFx(CHANNEL_1, 10, 0x4f, 0xc7, 0xf3, 0x73, 0x86);
   0159 C5                  332 	push	bc
   015A 21 86 00            333 	ld	hl,#0x0086
   015D E5                  334 	push	hl
   015E 2E 73               335 	ld	l, #0x73
   0160 E5                  336 	push	hl
   0161 2E F3               337 	ld	l, #0xf3
   0163 E5                  338 	push	hl
   0164 2E C7               339 	ld	l, #0xc7
   0166 E5                  340 	push	hl
   0167 2E 4F               341 	ld	l, #0x4f
   0169 E5                  342 	push	hl
   016A 21 00 0A            343 	ld	hl,#0x0a00
   016D E5                  344 	push	hl
   016E CDr00r00            345 	call	_PlayFx
   0171 E8 0C               346 	add	sp, #12
   0173 C1                  347 	pop	bc
                            348 ;SpriteEnemy.c:61: SpriteManagerRemoveSprite(spr);
   0174 C5                  349 	push	bc
   0175 CDr00r00            350 	call	_SpriteManagerRemoveSprite
   0178 E8 02               351 	add	sp, #2
   017A                     352 00113$:
                            353 ;SpriteEnemy.c:56: SPRITEMANAGER_ITERATE(i, spr) {
   017A F8 00               354 	ldhl	sp,#0
   017C 34                  355 	inc	(hl)
   017D 4E                  356 	ld	c,(hl)
   017E 06 00               357 	ld	b,#0x00
   0180 03                  358 	inc	bc
   0181 21r00r00            359 	ld	hl,#_sprite_manager_updatables
   0184 09                  360 	add	hl,bc
   0185 4D                  361 	ld	c,l
   0186 44                  362 	ld	b,h
   0187 0A                  363 	ld	a,(bc)
   0188 4F                  364 	ld	c,a
   0189 06 00               365 	ld	b,#0x00
   018B CB 21               366 	sla	c
   018D CB 10               367 	rl	b
   018F 21r00r00            368 	ld	hl,#_sprite_manager_sprites
   0192 09                  369 	add	hl,bc
   0193 4D                  370 	ld	c,l
   0194 44                  371 	ld	b,h
   0195 59                  372 	ld	e, c
   0196 50                  373 	ld	d, b
   0197 1A                  374 	ld	a,(de)
   0198 4F                  375 	ld	c,a
   0199 13                  376 	inc	de
   019A 1A                  377 	ld	a,(de)
   019B 47                  378 	ld	b,a
   019C C3r14r01            379 	jp	00112$
   019F                     380 00114$:
   019F E8 04               381 	add	sp, #4
   01A1 C9                  382 	ret
                            383 ;SpriteEnemy.c:68: void Destroy_SPRITE_ENEMY() {
                            384 ;	---------------------------------
                            385 ; Function Destroy_SPRITE_ENEMY
                            386 ; ---------------------------------
   01A2                     387 _Destroy_SPRITE_ENEMY::
                            388 ;SpriteEnemy.c:69: }
   01A2 C9                  389 	ret
                            390 	.area _CODE_2
                            391 	.area _CABS (ABS)
