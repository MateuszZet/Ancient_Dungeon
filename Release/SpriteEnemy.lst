                              1 ;--------------------------------------------------------
                              2 ; File Created by SDCC : free open source ANSI-C Compiler
                              3 ; Version 3.6.0 #9615 (MINGW64)
                              4 ;--------------------------------------------------------
                              5 	.module SpriteEnemy
                              6 	.optsdcc -mgbz80
                              7 	
                              8 ;--------------------------------------------------------
                              9 ; Public variables in this module
                             10 ;--------------------------------------------------------
                             11 	.globl _SpriteManagerRemoveSprite
                             12 	.globl _PlayFx
                             13 	.globl _CheckCollision
                             14 	.globl _TranslateSprite
                             15 	.globl _SetSpriteAnim
                             16 	.globl _dir_pointer
                             17 	.globl _dir
                             18 	.globl _bank_SPRITE_ENEMY
                             19 	.globl _anim_walk
                             20 	.globl _anim_walk2
                             21 	.globl _Start_SPRITE_ENEMY
                             22 	.globl _Update_SPRITE_ENEMY
                             23 	.globl _Destroy_SPRITE_ENEMY
                             24 ;--------------------------------------------------------
                             25 ; ram data
                             26 ;--------------------------------------------------------
                             27 	.area _DATA
   0000                      28 _bank_SPRITE_ENEMY::
   0000                      29 	.ds 1
   0001                      30 _dir::
   0001                      31 	.ds 2
   0003                      32 _dir_pointer::
   0003                      33 	.ds 2
                             34 ;--------------------------------------------------------
                             35 ; absolute external ram data
                             36 ;--------------------------------------------------------
                             37 	.area _DABS (ABS)
                             38 ;--------------------------------------------------------
                             39 ; global & static initialisations
                             40 ;--------------------------------------------------------
                             41 	.area _HOME
                             42 	.area _GSINIT
                             43 	.area _GSFINAL
                             44 	.area _GSINIT
                             45 ;SpriteEnemy.c:3: UINT8 bank_SPRITE_ENEMY = 2;
   0000 21r00r00             46 	ld	hl,#_bank_SPRITE_ENEMY
   0003 36 02                47 	ld	(hl),#0x02
                             48 ;SpriteEnemy.c:12: int dir=0;
   0005 21r01r00             49 	ld	hl,#_dir
   0008 36 00                50 	ld	(hl),#0x00
   000A 23                   51 	inc	hl
   000B 36 00                52 	ld	(hl),#0x00
                             53 ;SpriteEnemy.c:13: int *dir_pointer = NULL;
   000D 21r03r00             54 	ld	hl,#_dir_pointer
   0010 36 00                55 	ld	(hl),#0x00
   0012 23                   56 	inc	hl
   0013 36 00                57 	ld	(hl),#0x00
                             58 ;--------------------------------------------------------
                             59 ; Home
                             60 ;--------------------------------------------------------
                             61 	.area _HOME
                             62 	.area _HOME
                             63 ;--------------------------------------------------------
                             64 ; code
                             65 ;--------------------------------------------------------
                             66 	.area _CODE_2
                             67 ;SpriteEnemy.c:19: void Start_SPRITE_ENEMY() {
                             68 ;	---------------------------------
                             69 ; Function Start_SPRITE_ENEMY
                             70 ; ---------------------------------
   0000                      71 _Start_SPRITE_ENEMY::
   0000 E8 FC                72 	add	sp, #-4
                             73 ;SpriteEnemy.c:20: struct EnemyInfo* data = (struct EnemyInfo*)THIS->custom_data;
   0002 21r01r00             74 	ld	hl,#_THIS + 1
   0005 2B                   75 	dec	hl
   0006 4E                   76 	ld	c,(hl)
   0007 23                   77 	inc	hl
   0008 46                   78 	ld	b,(hl)
   0009 21 18 00             79 	ld	hl,#0x0018
   000C 09                   80 	add	hl,bc
   000D 7D                   81 	ld	a,l
   000E 54                   82 	ld	d,h
   000F F8 02                83 	ldhl	sp,#2
   0011 22                   84 	ld	(hl+),a
   0012 72                   85 	ld	(hl),d
   0013 2B                   86 	dec	hl
   0014 2A                   87 	ld	a,(hl+)
   0015 5E                   88 	ld	e, (hl)
   0016 F8 00                89 	ldhl	sp,#0
   0018 22                   90 	ld	(hl+),a
   0019 73                   91 	ld	(hl),e
                             92 ;SpriteEnemy.c:21: THIS->lim_x=9999;
   001A 21 12 00             93 	ld	hl,#0x0012
   001D 09                   94 	add	hl,bc
   001E 4D                   95 	ld	c,l
   001F 44                   96 	ld	b,h
   0020 3E 0F                97 	ld	a,#0x0f
   0022 02                   98 	ld	(bc),a
   0023 03                   99 	inc	bc
   0024 3E 27               100 	ld	a,#0x27
   0026 02                  101 	ld	(bc),a
                            102 ;SpriteEnemy.c:22: THIS->lim_y=9999;
   0027 21r01r00            103 	ld	hl,#_THIS + 1
   002A 2B                  104 	dec	hl
   002B 4E                  105 	ld	c,(hl)
   002C 23                  106 	inc	hl
   002D 46                  107 	ld	b,(hl)
   002E 21 14 00            108 	ld	hl,#0x0014
   0031 09                  109 	add	hl,bc
   0032 4D                  110 	ld	c,l
   0033 44                  111 	ld	b,h
   0034 3E 0F               112 	ld	a,#0x0f
   0036 02                  113 	ld	(bc),a
   0037 03                  114 	inc	bc
   0038 3E 27               115 	ld	a,#0x27
   003A 02                  116 	ld	(bc),a
                            117 ;SpriteEnemy.c:23: data->vy = 1;
   003B E1                  118 	pop	hl
   003C E5                  119 	push	hl
   003D 36 01               120 	ld	(hl),#0x01
                            121 ;SpriteEnemy.c:25: SetSpriteAnim(THIS, anim_walk2, 15);
   003F 3E 0F               122 	ld	a,#0x0f
   0041 F5                  123 	push	af
   0042 33                  124 	inc	sp
   0043 21r56r00            125 	ld	hl,#_anim_walk2
   0046 E5                  126 	push	hl
   0047 21r00r00            127 	ld	hl,#_THIS
   004A 2A                  128 	ld	a,(hl+)
   004B 66                  129 	ld	h,(hl)
   004C 6F                  130 	ld	l,a
   004D E5                  131 	push	hl
   004E CDr00r00            132 	call	_SetSpriteAnim
   0051 E8 05               133 	add	sp, #5
   0053 E8 04               134 	add	sp, #4
   0055 C9                  135 	ret
   0056                     136 _anim_walk2:
   0056 02                  137 	.db #0x02	; 2
   0057 01                  138 	.db #0x01	; 1
   0058 02                  139 	.db #0x02	; 2
   0059                     140 _anim_walk:
   0059 02                  141 	.db #0x02	; 2
   005A 03                  142 	.db #0x03	; 3
   005B 04                  143 	.db #0x04	; 4
                            144 ;SpriteEnemy.c:29: void Update_SPRITE_ENEMY() {
                            145 ;	---------------------------------
                            146 ; Function Update_SPRITE_ENEMY
                            147 ; ---------------------------------
   005C                     148 _Update_SPRITE_ENEMY::
   005C E8 FC               149 	add	sp, #-4
                            150 ;SpriteEnemy.c:34: struct EnemyInfo* data = (struct EnemyInfo*)THIS->custom_data;
   005E 21r01r00            151 	ld	hl,#_THIS + 1
   0061 2B                  152 	dec	hl
   0062 4E                  153 	ld	c,(hl)
   0063 23                  154 	inc	hl
   0064 46                  155 	ld	b,(hl)
   0065 21 18 00            156 	ld	hl,#0x0018
   0068 09                  157 	add	hl,bc
   0069 4D                  158 	ld	c,l
   006A 44                  159 	ld	b,h
                            160 ;SpriteEnemy.c:35: dir_pointer = &dir;
   006B 21r03r00            161 	ld	hl,#_dir_pointer
   006E 36r01               162 	ld	(hl),#<(_dir)
   0070 23                  163 	inc	hl
   0071 36s00               164 	ld	(hl),#>(_dir)
                            165 ;SpriteEnemy.c:39: if (TranslateSprite(THIS, 0 << delta_time, data->vy << delta_time)) {
   0073 0A                  166 	ld	a,(bc)
   0074 57                  167 	ld	d,a
   0075 21r00r00            168 	ld	hl,#_delta_time
   0078 7E                  169 	ld	a,(hl)
   0079 3C                  170 	inc	a
   007A 18 02               171 	jr	00143$
   007C                     172 00142$:
   007C CB 22               173 	sla	d
   007E                     174 00143$:
   007E 3D                  175 	dec	a
   007F 20 FB               176 	jr	NZ,00142$
   0081 7E                  177 	ld	a,(hl)
   0082 F5                  178 	push	af
   0083 1E 00               179 	ld	e,#0x00
   0085 F1                  180 	pop	af
   0086 3C                  181 	inc	a
   0087 18 02               182 	jr	00145$
   0089                     183 00144$:
   0089 CB 23               184 	sla	e
   008B                     185 00145$:
   008B 3D                  186 	dec	a
   008C 20 FB               187 	jr	NZ,00144$
   008E C5                  188 	push	bc
   008F D5                  189 	push	de
   0090 33                  190 	inc	sp
   0091 7B                  191 	ld	a,e
   0092 F5                  192 	push	af
   0093 33                  193 	inc	sp
   0094 21r00r00            194 	ld	hl,#_THIS
   0097 2A                  195 	ld	a,(hl+)
   0098 66                  196 	ld	h,(hl)
   0099 6F                  197 	ld	l,a
   009A E5                  198 	push	hl
   009B CDr00r00            199 	call	_TranslateSprite
   009E E8 04               200 	add	sp, #4
   00A0 C1                  201 	pop	bc
   00A1 7B                  202 	ld	a,e
   00A2 B7                  203 	or	a, a
   00A3 CAr12r01            204 	jp	Z,00105$
                            205 ;SpriteEnemy.c:41: data->vy = -data->vy;
   00A6 0A                  206 	ld	a,(bc)
   00A7 F8 03               207 	ldhl	sp,#3
   00A9 77                  208 	ld	(hl),a
   00AA AF                  209 	xor	a, a
   00AB 96                  210 	sub	a, (hl)
   00AC 77                  211 	ld	(hl),a
   00AD 7E                  212 	ld	a,(hl)
   00AE 02                  213 	ld	(bc),a
                            214 ;SpriteEnemy.c:43: PlayFx(CHANNEL_4, 4, 0x0c, 0x41, 0x30, 0xc0);
   00AF 21 C0 00            215 	ld	hl,#0x00c0
   00B2 E5                  216 	push	hl
   00B3 2E 30               217 	ld	l, #0x30
   00B5 E5                  218 	push	hl
   00B6 2E 41               219 	ld	l, #0x41
   00B8 E5                  220 	push	hl
   00B9 2E 0C               221 	ld	l, #0x0c
   00BB E5                  222 	push	hl
   00BC 21 03 04            223 	ld	hl,#0x0403
   00BF E5                  224 	push	hl
   00C0 CDr00r00            225 	call	_PlayFx
   00C3 E8 0A               226 	add	sp, #10
                            227 ;SpriteEnemy.c:44: if (dir == 0) {
   00C5 21r02r00            228 	ld	hl,#_dir + 1
   00C8 3A                  229 	ld	a,(hl-)
   00C9 B6                  230 	or	a,(hl)
   00CA 20 24               231 	jr	NZ,00102$
                            232 ;SpriteEnemy.c:45: SetSpriteAnim(THIS, anim_walk, 15);
   00CC 3E 0F               233 	ld	a,#0x0f
   00CE F5                  234 	push	af
   00CF 33                  235 	inc	sp
   00D0 21r59r00            236 	ld	hl,#_anim_walk
   00D3 E5                  237 	push	hl
   00D4 21r00r00            238 	ld	hl,#_THIS
   00D7 2A                  239 	ld	a,(hl+)
   00D8 66                  240 	ld	h,(hl)
   00D9 6F                  241 	ld	l,a
   00DA E5                  242 	push	hl
   00DB CDr00r00            243 	call	_SetSpriteAnim
   00DE E8 05               244 	add	sp, #5
                            245 ;SpriteEnemy.c:46: *dir_pointer = 1;
   00E0 21r04r00            246 	ld	hl,#_dir_pointer + 1
   00E3 2B                  247 	dec	hl
   00E4 4E                  248 	ld	c,(hl)
   00E5 23                  249 	inc	hl
   00E6 46                  250 	ld	b,(hl)
   00E7 3E 01               251 	ld	a,#0x01
   00E9 02                  252 	ld	(bc),a
   00EA 03                  253 	inc	bc
   00EB 3E 00               254 	ld	a,#0x00
   00ED 02                  255 	ld	(bc),a
   00EE 18 22               256 	jr	00105$
   00F0                     257 00102$:
                            258 ;SpriteEnemy.c:49: SetSpriteAnim(THIS, anim_walk2, 15);
   00F0 3E 0F               259 	ld	a,#0x0f
   00F2 F5                  260 	push	af
   00F3 33                  261 	inc	sp
   00F4 21r56r00            262 	ld	hl,#_anim_walk2
   00F7 E5                  263 	push	hl
   00F8 21r00r00            264 	ld	hl,#_THIS
   00FB 2A                  265 	ld	a,(hl+)
   00FC 66                  266 	ld	h,(hl)
   00FD 6F                  267 	ld	l,a
   00FE E5                  268 	push	hl
   00FF CDr00r00            269 	call	_SetSpriteAnim
   0102 E8 05               270 	add	sp, #5
                            271 ;SpriteEnemy.c:50: *dir_pointer = 0;
   0104 21r04r00            272 	ld	hl,#_dir_pointer + 1
   0107 2B                  273 	dec	hl
   0108 4E                  274 	ld	c,(hl)
   0109 23                  275 	inc	hl
   010A 46                  276 	ld	b,(hl)
   010B 3E 00               277 	ld	a,#0x00
   010D 02                  278 	ld	(bc),a
   010E 03                  279 	inc	bc
   010F 3E 00               280 	ld	a,#0x00
   0111 02                  281 	ld	(bc),a
   0112                     282 00105$:
                            283 ;SpriteEnemy.c:56: SPRITEMANAGER_ITERATE(i, spr) {
   0112 FAr01r00            284 	ld	a, (#(_sprite_manager_updatables + 0x0001) + 0)
   0115 4F                  285 	ld	c,a
   0116 06 00               286 	ld	b,#0x00
   0118 CB 21               287 	sla	c
   011A CB 10               288 	rl	b
   011C 21r00r00            289 	ld	hl,#_sprite_manager_sprites
   011F 09                  290 	add	hl,bc
   0120 4D                  291 	ld	c,l
   0121 44                  292 	ld	b,h
   0122 59                  293 	ld	e, c
   0123 50                  294 	ld	d, b
   0124 1A                  295 	ld	a,(de)
   0125 F8 00               296 	ldhl	sp,#0
   0127 22                  297 	ld	(hl+),a
   0128 13                  298 	inc	de
   0129 1A                  299 	ld	a,(de)
   012A 22                  300 	ld	(hl+),a
   012B 36 00               301 	ld	(hl),#0x00
   012D                     302 00113$:
   012D 11r00r00            303 	ld	de, #_sprite_manager_updatables + 0
   0130 1A                  304 	ld	a,(de)
   0131 4F                  305 	ld	c,a
   0132 F8 02               306 	ldhl	sp,#2
   0134 7E                  307 	ld	a,(hl)
   0135 91                  308 	sub	a, c
   0136 CArB4r01            309 	jp	Z,00115$
                            310 ;SpriteEnemy.c:57: if (spr->type == SPRITE_BOMB || spr->type == SPRITE_BOMB_L) {
   0139 D1                  311 	pop	de
   013A D5                  312 	push	de
   013B 21 10 00            313 	ld	hl,#0x0010
   013E 19                  314 	add	hl,de
   013F 4D                  315 	ld	c,l
   0140 44                  316 	ld	b,h
   0141 0A                  317 	ld	a,(bc)
   0142 4F                  318 	ld	c,a
   0143 D6 06               319 	sub	a, #0x06
   0145 28 06               320 	jr	Z,00108$
   0147 79                  321 	ld	a,c
   0148 D6 07               322 	sub	a, #0x07
   014A C2r8Dr01            323 	jp	NZ,00114$
   014D                     324 00108$:
                            325 ;SpriteEnemy.c:58: if (CheckCollision(THIS, spr)) {
   014D E1                  326 	pop	hl
   014E E5                  327 	push	hl
   014F E5                  328 	push	hl
   0150 21r00r00            329 	ld	hl,#_THIS
   0153 2A                  330 	ld	a,(hl+)
   0154 66                  331 	ld	h,(hl)
   0155 6F                  332 	ld	l,a
   0156 E5                  333 	push	hl
   0157 CDr00r00            334 	call	_CheckCollision
   015A E8 04               335 	add	sp, #4
   015C 7B                  336 	ld	a,e
   015D B7                  337 	or	a, a
   015E 28 2D               338 	jr	Z,00114$
                            339 ;SpriteEnemy.c:59: SpriteManagerRemoveSprite(THIS);
   0160 21r00r00            340 	ld	hl,#_THIS
   0163 2A                  341 	ld	a,(hl+)
   0164 66                  342 	ld	h,(hl)
   0165 6F                  343 	ld	l,a
   0166 E5                  344 	push	hl
   0167 CDr00r00            345 	call	_SpriteManagerRemoveSprite
   016A E8 02               346 	add	sp, #2
                            347 ;SpriteEnemy.c:60: PlayFx(CHANNEL_1, 10, 0x1e, 0x10, 0xf3, 0x00, 0x87);
   016C 21 87 00            348 	ld	hl,#0x0087
   016F E5                  349 	push	hl
   0170 2E 00               350 	ld	l, #0x00
   0172 E5                  351 	push	hl
   0173 2E F3               352 	ld	l, #0xf3
   0175 E5                  353 	push	hl
   0176 2E 10               354 	ld	l, #0x10
   0178 E5                  355 	push	hl
   0179 2E 1E               356 	ld	l, #0x1e
   017B E5                  357 	push	hl
   017C 21 00 0A            358 	ld	hl,#0x0a00
   017F E5                  359 	push	hl
   0180 CDr00r00            360 	call	_PlayFx
   0183 E8 0C               361 	add	sp, #12
                            362 ;SpriteEnemy.c:61: SpriteManagerRemoveSprite(spr);
   0185 E1                  363 	pop	hl
   0186 E5                  364 	push	hl
   0187 E5                  365 	push	hl
   0188 CDr00r00            366 	call	_SpriteManagerRemoveSprite
   018B E8 02               367 	add	sp, #2
   018D                     368 00114$:
                            369 ;SpriteEnemy.c:56: SPRITEMANAGER_ITERATE(i, spr) {
   018D F8 02               370 	ldhl	sp,#2
   018F 34                  371 	inc	(hl)
   0190 4E                  372 	ld	c,(hl)
   0191 06 00               373 	ld	b,#0x00
   0193 03                  374 	inc	bc
   0194 21r00r00            375 	ld	hl,#_sprite_manager_updatables
   0197 09                  376 	add	hl,bc
   0198 4D                  377 	ld	c,l
   0199 44                  378 	ld	b,h
   019A 0A                  379 	ld	a,(bc)
   019B 4F                  380 	ld	c,a
   019C 06 00               381 	ld	b,#0x00
   019E CB 21               382 	sla	c
   01A0 CB 10               383 	rl	b
   01A2 21r00r00            384 	ld	hl,#_sprite_manager_sprites
   01A5 09                  385 	add	hl,bc
   01A6 4D                  386 	ld	c,l
   01A7 44                  387 	ld	b,h
   01A8 59                  388 	ld	e, c
   01A9 50                  389 	ld	d, b
   01AA 1A                  390 	ld	a,(de)
   01AB F8 00               391 	ldhl	sp,#0
   01AD 22                  392 	ld	(hl+),a
   01AE 13                  393 	inc	de
   01AF 1A                  394 	ld	a,(de)
   01B0 77                  395 	ld	(hl),a
   01B1 C3r2Dr01            396 	jp	00113$
   01B4                     397 00115$:
   01B4 E8 04               398 	add	sp, #4
   01B6 C9                  399 	ret
                            400 ;SpriteEnemy.c:68: void Destroy_SPRITE_ENEMY() {
                            401 ;	---------------------------------
                            402 ; Function Destroy_SPRITE_ENEMY
                            403 ; ---------------------------------
   01B7                     404 _Destroy_SPRITE_ENEMY::
                            405 ;SpriteEnemy.c:69: }
   01B7 C9                  406 	ret
                            407 	.area _CODE_2
                            408 	.area _CABS (ABS)
